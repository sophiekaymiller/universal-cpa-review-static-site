## Customize the test machine
machine:
  timezone:
    America/Los_Angeles # Set the timezone
  ruby:
    version:
      2.3.2
  python:
    version:
      2.7
  node:
    version:
      8.3

dependencies:
  pre:
    - sudo apt-get update
    - pip install --upgrade setuptools
    - pip install cffi
    - pip install ansible
    - gem install jekyll --no-rdoc --no-ri

compile:
  override:
    - npm run build

test:
  override:
    - echo 'NO TESTS'

deployment:
  staging:
    branch: /feature.*/
    commands:
      - mv _site _ansible/
      - ansible-playbook _ansible/site.yml -i _ansible/staging -e "build=staging-build server_name=staging.universalcpareview.com"

  production:
    tag: /.*?/
    commands:
      - mv _site _ansible/
      - ansible-playbook _ansible/site.yml -i _ansible/production -e "build=$CIRCLE_TAG server_name=www.universalcpareview.com"